insert into dominancia (nacao, planeta, data_ini, data_fim)
values ('Deserunt vero.', 'Laborum nihil.', to_date('02/02/2002','dd/mm/yyyy'), null);

insert into dominancia (nacao, planeta, data_ini, data_fim)
values ('Deserunt vero.', 'Et iure earum.', to_date('04/05/1025','dd/mm/yyyy'), null);

insert into dominancia (nacao, planeta, data_ini, data_fim)
values ('Nam ut a.', 'Ut quisquam.', to_date('04/05/1025','dd/mm/yyyy'), to_date('16/05/2005','dd/mm/yyyy'));

select dom.nacao as nacao_atual from planeta p
join dominancia dom on dom.planeta = p.id_astro where dom.data_fim > current_date or dom.data_fim is null;

select p.id_astro, dom.nacao as nacao_atual, dom.data_ini, dom.data_fim from planeta p
right join dominancia dom on dom.planeta = p.id_astro 
;

select distinct p.id_astro,dom.nacao as nacao_atual, dom.data_ini, dom.data_fim
from planeta p
join dominancia dom on dom.planeta = p.id_astro
order by p.id_astro, dom.data_ini desc;
-- pegar a primeira linha que contem o planeta
-- jogar isso em uma coleção e tratar a parte de trazer apenas uma linha por planeta com PL


select distinct p.id_astro,dom.nacao as nacao_atual, dom.data_ini, dom.data_fim
from planeta p
join dominancia dom on dom.planeta = p.id_astro
order by p.id_astro, dom.data_ini desc;
-- jogar isso em uma coleção e tratar a parte de trazer apenas uma linha por planeta com PL


insert into habitacao (planeta,especie,comunidade,data_ini, data_fim)
values ('Et iure earum.', 'Id sed', 'Teste3', to_date('12/12/2001', 'dd/mm/yyyy'), to_date('10/10/2010', 'dd/mm/yyyy'));

insert into habitacao (planeta,especie,comunidade,data_ini, data_fim)
values ('Et iure earum.', 'Ea qui modi', 'Teste0', to_date('12/12/2001', 'dd/mm/yyyy'), to_date('10/10/2010', 'dd/mm/yyyy'));

select * from habitacao;

select distinct hab.planeta, count(hab.comunidade), count(especie), count(qtd_habitantes) 
from habitacao hab join comunidade comu where group by planeta;               



